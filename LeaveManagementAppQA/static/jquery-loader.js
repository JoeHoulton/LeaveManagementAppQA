!function(i){i.loader_ext={defaults:{autoCheck:32,css:{},size:16,bgColor:"#FFF",bgOpacity:.5,fontColor:!1,position:[0,0,0,0],title:"Please Wait",isOnly:!1,imgUrl:"/static/images/loading[size].gif",onShow:function(){},onClose:function(){}},template:function(o,s){return i.each(s,function(i,s){o=o.replace("${"+i+"}",s)}),i(o)},init:function(o,s){return this.options=i.extend({},this.defaults,s),this.scope=o,this.scope.is(":hidden")?void 0:(this.checkScope(),this.check_position(),this.check_unique(),this.create(),this.set_css(),this.set_define(),this.show(),this.loading)},checkScope:function(){this.options.autoCheck&&((this.scope.is("body")||this.scope.is("div")||this.scope.is("form"))&&(this.options.size=this.options.autoCheck),(this.scope.is("input")||this.scope.is("button"))&&(this.options.title=""))},check_position:function(){for(var i=this.options.position,o=0;4>o;o++)void 0===i[o]&&(i[o]=0);this.options.position=i},check_unique:function(){this.options.isOnly&&void 0!==this.loading&&this.close()},create:function(){var o=this.options;o.imgUrl=o.imgUrl.replace("[size]",o.size+"x"+o.size),this.loading=this.template(i.loader.tmpl,{Class:"x"+o.size,Src:o.imgUrl,Title:o.title}).hide(),this.loading.appendTo(i("body"))},set_css:function(){var o=this.scope,s=this.options,t=this.loading,n=o.outerHeight(),e=o.outerWidth(),c=o.offset().top,r=o.offset().left;t.css("top",c),o.is("body")&&(n=i(window).height(),e=i(window).width(),t.css("position","fixed"),this.for_ie6()),t.css({height:n+s.position[2],width:e+s.position[3],left:r,"border-radius":o.css("border-radius")}).css(s.css);var l=t.children();l.css({"margin-top":(n-s.size)/2+s.position[0],"margin-left":(e-s.size)/2+s.position[1]-l.find("span").outerWidth()/2})},set_define:function(){var o=this.options,s=this.loading;o.bgColor?s.css({"background-color":o.bgColor,opacity:o.bgOpacity,filter:"alpha(opacity="+100*o.bgOpacity+")"}):s.css("background","none"),o.fontColor&&s.find("span").css("color",o.fontColor);var t=this;i(window).resize(function(){t.loading&&t.set_css()})},for_ie6:function(){var o=this.loading;i.browser&&i.browser.msie&&"6.0"==i.browser.version&&(o.css({position:"absolute",top:i(window).scrollTop()}),i(window).scroll(function(){o.css("top",i(window).scrollTop())}))},show:function(){var o=this.options;this.loading.show(1,function(){var s=i(this).children(),t=s.css("margin-left").replace("px","");s.css("margin-left",t-s.find("span").outerWidth()/2),o.onShow(this.loading)})},close:function(o){if(o){var s=i(i.loader.tmpl).attr("class");i("."+s).remove()}else void 0!=this.loading&&(this.loading.remove(),this.loading=void 0);void 0!=this.options&&this.options.onClose()}},i.loader={tmpl:'<div class="loading_wrp"><div class="loading ${Class}"><img src="${Src}"/><span><span>${Title}</span></div></div>',open:function(o){return i("body").loader(o)},close:function(o){i.loader_ext.close(o)}},i.fn.loader=function(o){if(i(this).size()){"string"===i.type(o)&&(o={title:o});var s=i(this);return s.size()>1&&(s=s.parent()),i.loader_ext.init(s,o)}}}(jQuery);